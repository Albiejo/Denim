<%-include(".././../Layouts/adminhead.ejs")%>
        <section class="content-main">
            <div class="row">
                <div class="col-9">
                    <div class="content-header">
                        <h2 class="content-title">Add new Coupons</h2>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="card mb-4">
                       
                        <div class="card-body">
                            <form action="/admin/coupons" method="post" onsubmit="return checkCoupon()">
                                <div class="mb-4">
                                    <div class="row">
                                        <div class="col-lg-4">
                                            <label for="couponcode" style="color: black;font-weight: bold;">Coupon code:</label><br>
                                            <input type="text"name="couponcode" id="couponcode">
                                            <div id="codeerror" style="color: red;"></div>
                                        </div>
                                        <div class="col-lg-4">
                                            <label for="coupondiscription" style="color: black;font-weight: bold;">Coupon Discription:</label><br>
                                            <input type="text"name="coupondiscription" id="coupondiscription">
                                            <div id="discerror" style="color: red;"></div>
                                        </div>

                                        <div class="col-lg-4">
                                            <label for="Discount" style="color: black;font-weight: bold;">Discount:</label><br>
                                            <input type="number" name="Discount" id="Discount">
                                            <div id="discounterror" style="color: red;"></div>
                                        </div>
                                        <div class="col-lg-4">
                                            <label for="MazimumAmount" style="color: black;font-weight: bold;">Maximum Amount:</label><br>
                                            <input type="number" name="MazimumAmount" id="MazimumAmount">
                                            <div id="maximumerror" style="color: red;"></div>
                                        </div>
                                        <div class="col-lg-4">
                                            <label for="MinimumAmount" style="color: black;font-weight: bold;">Minimum Amount:</label><br>
                                            <input type="number" name="MinimumAmount" id="MinimumAmount">
                                            <div id="minimumerror" style="color: red;"></div>
                                        </div>
                                        <div class="col-lg-4">
                                            <label for="couponexpiry" style="color: black;font-weight: bold;">Coupon expiry:</label><br>
                                            <input type="date" name="couponexpiry" id="couponexpiry">
                                            <div id="expiryerror" style="color: red;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary"><i
                                            class="text-muted material-icons md-post_add"></i>Publish Coupon</button>
                                </div>
                            </form>
                        </div>
                    </div> <!-- card end// -->
                </div>


                <div class="col-lg-12">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h4>COUPON DETAILS</h4>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Sl.No</th>
                                            <th>Code</th>
                                            <th>Description</th>
                                            <th>Discount</th>
                                            <th>Expiry</th>
                                            <th></th>
                                            <td></td>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <%for(let i=0; i< couponData.length; i++){%>
                                            <tr>
                                                <td>
                                                   <span style="color: black; font-weight: bolder;"><%=i+1%></span> 
                                                </td>

                                                <td>
                                                    <span style="color: rgb(255, 0, 0); font-weight: bolder;"> <%=couponData[i].Code%></span>
                                                </td>
                                                <td>
                                                    <span style="color: black; font-weight: bolder;"><%=couponData[i].Discription%></span> 
                                                </td>
                                                <td>
                                                    <span style="color: black; font-weight: bolder; background-color: yellow;"><%=couponData[i].Discount%>%</span>  
                                                </td>
                                                <td>
                                                    <span style="color: black; font-weight: bolder;"><%=couponData[i].Expiry%></span> 
                                                </td>
                                                <td>
                                               <a href="/admin/editCoupon?id=<%=couponData[i]._id%>"><button class="btn btn-success">Edit</button></a>
                                                </td>
                                                <td>
                                                    <a href="/admin/deleteCoupon?id=<%=couponData[i]._id%>" class="delete-link">
                                                        <button class="btn btn-danger">Delete</button>
                                                    </a>
                                                    
                                                </td>

                                            </tr>
                                            <%}%>
                                    </tbody>
                                    <div class="pagination">
                                        <% if (currentPage > 1) { %>
                                          <a href="/admin/coupons?page=<%= currentPage - 1 %>">&laquo; Previous &nbsp;</a>
                                        <% } %>
                                      
                                        Page <%= currentPage %> of <%= totalPages %>
                                      <br>
                                        <% if (currentPage < totalPages) { %>
                                          <a href="/admin/coupons?page=<%= currentPage + 1 %>"> &nbsp; Next &raquo;</a>
                                        <% } %>
                                      </div>
                            
                                      <br><br><br>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    

            
           
           
        </section> <!-- content-main end// -->
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> Â©, Denim Stores  .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <script src="admin-assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="admin-assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="admin-assets/js/vendors/select2.min.js"></script>
    <script src="admin-assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="admin-assets/js/vendors/jquery.fullscreen.min.js"></script>
    <script src="admin-assets/js/vendors/chart.js"></script>
    <!-- Main Script -->
    <script src="admin-assets/js/main.js" type="text/javascript"></script>
    <script src="admin-assets/js/custom-chart.js" type="text/javascript"></script>
    <script>
        const couponCode = document.getElementById('couponcode');
        const couponDescription = document.getElementById('coupondiscription');
        const couponDiscount = document.getElementById('Discount');
        const couponExpiry = document.getElementById('couponexpiry');
        const maximumAmount = document.getElementById('MazimumAmount');
        const minimumAmount = document.getElementById('MinimumAmount');
        
        
        
        const couponCodeError = document.getElementById('codeerror');
        const couponDescriptionError = document.getElementById('discerror');
        const couponDiscountError = document.getElementById('discounterror');
        const couponExpiryError = document.getElementById('expiryerror');
        const maximumAmountError = document.getElementById('maximumerror');
        const minimumAmountError = document.getElementById('minimumerror');




        

        couponCode.addEventListener('input', () => {
            const val = couponCode.value;
            const isValid = validateCode(val);
            
        });

        couponDescription.addEventListener('input', () => {
            const val = couponDescription.value;
            const isValid = validateDescription(val);
            
        });
        couponDiscount.addEventListener('input', () => {
            const val = couponDiscount.value;
            const isValid = validateDiscount(val);
            
        });
        couponExpiry.addEventListener('input', () => {
            const val = couponExpiry.value;
            const isValid = validateExpiry(val);
            
        });
        maximumAmount.addEventListener('input', () => {
            const val = maximumAmount.value;
            const isValid = validateMax(val);
            
        });
        minimumAmount.addEventListener('input', () => {
            const val = minimumAmount.value;
            const isValid = validateMin(val);
            
        });





        function validateCode(val) {
            if(val.trim().length < 1){
                couponCodeError.textContent="Coupon cannot be empty"
                return false
            }
            couponCodeError.textContent=""
            return true
        }
        

        function validateDescription(val) {
            if(val.trim().length < 1){
                couponDescriptionError.textContent="Description cannot be empty"
                return false
            }
            couponDescriptionError.textContent=""
            return true
        }

        function validateDiscount(val) {
            if(val.trim().length < 1){
                couponDiscountError.textContent="Discount cannot be empty"
                return false
            }
            if(isNaN(val.trim())){
                couponDiscountError.textContent="Discount should be a valid number"
                return false
            }
            couponDiscountError.textContent=""
            return true
        }
        function validateExpiry(val) {
            if(val.trim().length < 1){
                couponExpiryError.textContent="Date cannot be empty"
                return false
            }
            couponExpiryError.textContent=""
            return true
        }
        function validateMax(val) {
            if(val.trim().length < 1){
                maximumAmountError.textContent="Value cannot be empty"
                return false
            }
            if(isNaN(val.trim())||val.trim()<1){
                maximumAmountError.textContent="It should be a valid number"
                return false
            }
            maximumAmountError.textContent=""
            return true
        }
        function validateMin(val) {
            if(val.trim().length < 1){
                minimumAmountError.textContent="Value cannot be empty"
                return false
            }
            if(isNaN(val.trim())||val.trim()<0){
                minimumAmountError.textContent="It should be a valid number"
                return false
            }
            minimumAmountError.textContent=""
            return true
        }


        function checkCoupon(){
            let isCode=validateCode(couponCode.value)
            let isDes=validateDescription(couponDescription.value)
            let isDis=validateDiscount(couponDiscount.value)
            let isExp=validateExpiry(couponExpiry.value)
            let isMax=validateMax(maximumAmount.value)
            let isMin=validateMin(minimumAmount.value)

            if(isCode && isDes && isDis && isExp  && isMax && isMin){
                return true
            }
            else{
                return false
            }
        }
        
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script>
         const deleteLinks = document.querySelectorAll('.delete-link');

deleteLinks.forEach(link => {
    link.addEventListener('click', (event) => {
        event.preventDefault(); // Prevent the default link behavior

        // Show the SweetAlert confirmation dialog
        Swal.fire({
            title: 'Are you sure?',
            text: 'You are about to delete this item.',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'No, cancel!',
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {
                // If the user confirms the delete, navigate to the delete URL
                window.location.href = link.getAttribute('href');
            }
        });
    });
});
    </script>
</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:57 GMT -->
</html>